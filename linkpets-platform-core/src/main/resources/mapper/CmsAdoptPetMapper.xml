<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.linkpets.core.dao.CmsAdoptPetMapper">
    <resultMap id="BaseResultMap" type="com.linkpets.core.model.CmsAdoptPet">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun May 19 12:29:03 CST 2019.
        -->
        <id column="pet_id" jdbcType="VARCHAR" property="petId"/>
        <result column="pet_name" jdbcType="VARCHAR" property="petName"/>
        <result column="pet_age" jdbcType="VARCHAR" property="petAge"/>
        <result column="pet_type" jdbcType="VARCHAR" property="petType"/>
        <result column="pet_sex" jdbcType="VARCHAR" property="petSex"/>
        <result column="pet_sterilization" jdbcType="VARCHAR" property="petSterilization"/>
        <result column="pet_vaccine" jdbcType="VARCHAR" property="petVaccine"/>
        <result column="pet_parasite" jdbcType="VARCHAR" property="petParasite"/>
        <result column="pet_from" jdbcType="VARCHAR" property="petFrom"/>
        <result column="pet_somatotype" jdbcType="VARCHAR" property="petSomatotype"/>
        <result column="pet_hair" jdbcType="VARCHAR" property="petHair"/>
        <result column="pet_characteristic" jdbcType="VARCHAR" property="petCharacteristic"/>
        <result column="adopt_requirements" jdbcType="VARCHAR" property="adoptRequirements"/>
        <result column="story" jdbcType="VARCHAR" property="story"/>
        <result column="address" jdbcType="VARCHAR" property="address"/>
        <result column="wx_id" jdbcType="VARCHAR" property="wxId"/>
        <result column="mobile_phone" jdbcType="VARCHAR" property="mobilePhone"/>
        <result column="adopt_status" jdbcType="VARCHAR" property="adoptStatus"/>
        <result column="memo" jdbcType="VARCHAR" property="memo"/>
        <result column="create_by" jdbcType="VARCHAR" property="createBy"/>
        <result column="create_date" jdbcType="TIMESTAMP" property="createDate"/>
        <result column="is_valid" jdbcType="VARCHAR" property="isValid"/>
    </resultMap>
    <resultMap id="BaseListResultMap" type="com.linkpets.core.model.CmsAdoptPet">
        <id column="pet_id" jdbcType="VARCHAR" property="petId"/>
        <result column="pet_name" jdbcType="VARCHAR" property="petName"/>
        <result column="pet_age" jdbcType="VARCHAR" property="petAge"/>
        <result column="pet_type" jdbcType="VARCHAR" property="petType"/>
        <result column="pet_sex" jdbcType="VARCHAR" property="petSex"/>
        <result column="pet_sterilization" jdbcType="VARCHAR" property="petSterilization"/>
        <result column="pet_vaccine" jdbcType="VARCHAR" property="petVaccine"/>
        <result column="pet_parasite" jdbcType="VARCHAR" property="petParasite"/>
        <result column="pet_from" jdbcType="VARCHAR" property="petFrom"/>
        <result column="pet_somatotype" jdbcType="VARCHAR" property="petSomatotype"/>
        <result column="pet_hair" jdbcType="VARCHAR" property="petHair"/>
        <result column="pet_characteristic" jdbcType="VARCHAR" property="petCharacteristic"/>
        <result column="adopt_requirements" jdbcType="VARCHAR" property="adoptRequirements"/>
        <result column="story" jdbcType="VARCHAR" property="story"/>
        <result column="address" jdbcType="VARCHAR" property="address"/>
        <result column="wx_id" jdbcType="VARCHAR" property="wxId"/>
        <result column="mobile_phone" jdbcType="VARCHAR" property="mobilePhone"/>
        <result column="adopt_status" jdbcType="VARCHAR" property="adoptStatus"/>
        <result column="memo" jdbcType="VARCHAR" property="memo"/>
        <result column="create_by" jdbcType="VARCHAR" property="createBy"/>
        <result column="create_date" jdbcType="TIMESTAMP" property="createDate"/>
        <result column="is_valid" jdbcType="VARCHAR" property="isValid"/>
        <collection property="mediaList" column="pet_id" select="selectAdoptionImage">

        </collection>
    </resultMap>

    <resultMap id="imageResultMap" type="com.linkpets.core.model.CmsAdoptPetMedia">
        <result property="mediaPath" column="media_path"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun May 19 12:29:03 CST 2019.
        -->
        pet_id, pet_name, pet_age, pet_type, pet_sex, pet_sterilization, pet_vaccine, pet_parasite,
        pet_from, pet_somatotype, pet_hair, pet_characteristic, adopt_requirements, story,
        address, wx_id, mobile_phone, adopt_status, memo, create_by, create_date, is_valid
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun May 19 12:29:03 CST 2019.
        -->
        select
        <include refid="Base_Column_List"/>
        from cms_adopt_pet
        where pet_id = #{petId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun May 19 12:29:03 CST 2019.
        -->
        delete from cms_adopt_pet
        where pet_id = #{petId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.linkpets.core.model.CmsAdoptPet">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun May 19 12:29:03 CST 2019.
        -->
        insert into cms_adopt_pet (pet_id, pet_name, pet_age,
        pet_type, pet_sex, pet_sterilization,
        pet_vaccine, pet_parasite, pet_from,
        pet_somatotype, pet_hair, pet_characteristic,
        adopt_requirements, story, address,
        wx_id, mobile_phone, adopt_status,
        memo, create_by, create_date,
        is_valid)
        values (#{petId,jdbcType=VARCHAR}, #{petName,jdbcType=VARCHAR}, #{petAge,jdbcType=VARCHAR},
        #{petType,jdbcType=VARCHAR}, #{petSex,jdbcType=VARCHAR}, #{petSterilization,jdbcType=VARCHAR},
        #{petVaccine,jdbcType=VARCHAR}, #{petParasite,jdbcType=VARCHAR}, #{petFrom,jdbcType=VARCHAR},
        #{petSomatotype,jdbcType=VARCHAR}, #{petHair,jdbcType=VARCHAR}, #{petCharacteristic,jdbcType=VARCHAR},
        #{adoptRequirements,jdbcType=VARCHAR}, #{story,jdbcType=VARCHAR}, #{address,jdbcType=VARCHAR},
        #{wxId,jdbcType=VARCHAR}, #{mobilePhone,jdbcType=VARCHAR}, #{adoptStatus,jdbcType=VARCHAR},
        #{memo,jdbcType=VARCHAR}, #{createBy,jdbcType=VARCHAR}, #{createDate,jdbcType=TIMESTAMP},
        #{isValid,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.linkpets.core.model.CmsAdoptPet">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun May 19 12:29:03 CST 2019.
        -->
        insert into cms_adopt_pet
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="petId != null">
                pet_id,
            </if>
            <if test="petName != null">
                pet_name,
            </if>
            <if test="petAge != null">
                pet_age,
            </if>
            <if test="petType != null">
                pet_type,
            </if>
            <if test="petSex != null">
                pet_sex,
            </if>
            <if test="petSterilization != null">
                pet_sterilization,
            </if>
            <if test="petVaccine != null">
                pet_vaccine,
            </if>
            <if test="petParasite != null">
                pet_parasite,
            </if>
            <if test="petFrom != null">
                pet_from,
            </if>
            <if test="petSomatotype != null">
                pet_somatotype,
            </if>
            <if test="petHair != null">
                pet_hair,
            </if>
            <if test="petCharacteristic != null">
                pet_characteristic,
            </if>
            <if test="adoptRequirements != null">
                adopt_requirements,
            </if>
            <if test="story != null">
                story,
            </if>
            <if test="address != null">
                address,
            </if>
            <if test="wxId != null">
                wx_id,
            </if>
            <if test="mobilePhone != null">
                mobile_phone,
            </if>
            <if test="adoptStatus != null">
                adopt_status,
            </if>
            <if test="memo != null">
                memo,
            </if>
            <if test="createBy != null">
                create_by,
            </if>
            <if test="createDate != null">
                create_date,
            </if>
            <if test="isValid != null">
                is_valid,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="petId != null">
                #{petId,jdbcType=VARCHAR},
            </if>
            <if test="petName != null">
                #{petName,jdbcType=VARCHAR},
            </if>
            <if test="petAge != null">
                #{petAge,jdbcType=VARCHAR},
            </if>
            <if test="petType != null">
                #{petType,jdbcType=VARCHAR},
            </if>
            <if test="petSex != null">
                #{petSex,jdbcType=VARCHAR},
            </if>
            <if test="petSterilization != null">
                #{petSterilization,jdbcType=VARCHAR},
            </if>
            <if test="petVaccine != null">
                #{petVaccine,jdbcType=VARCHAR},
            </if>
            <if test="petParasite != null">
                #{petParasite,jdbcType=VARCHAR},
            </if>
            <if test="petFrom != null">
                #{petFrom,jdbcType=VARCHAR},
            </if>
            <if test="petSomatotype != null">
                #{petSomatotype,jdbcType=VARCHAR},
            </if>
            <if test="petHair != null">
                #{petHair,jdbcType=VARCHAR},
            </if>
            <if test="petCharacteristic != null">
                #{petCharacteristic,jdbcType=VARCHAR},
            </if>
            <if test="adoptRequirements != null">
                #{adoptRequirements,jdbcType=VARCHAR},
            </if>
            <if test="story != null">
                #{story,jdbcType=VARCHAR},
            </if>
            <if test="address != null">
                #{address,jdbcType=VARCHAR},
            </if>
            <if test="wxId != null">
                #{wxId,jdbcType=VARCHAR},
            </if>
            <if test="mobilePhone != null">
                #{mobilePhone,jdbcType=VARCHAR},
            </if>
            <if test="adoptStatus != null">
                #{adoptStatus,jdbcType=VARCHAR},
            </if>
            <if test="memo != null">
                #{memo,jdbcType=VARCHAR},
            </if>
            <if test="createBy != null">
                #{createBy,jdbcType=VARCHAR},
            </if>
            <if test="createDate != null">
                #{createDate,jdbcType=TIMESTAMP},
            </if>
            <if test="isValid != null">
                #{isValid,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.linkpets.core.model.CmsAdoptPet">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun May 19 12:29:03 CST 2019.
        -->
        update cms_adopt_pet
        <set>
            <if test="petName != null">
                pet_name = #{petName,jdbcType=VARCHAR},
            </if>
            <if test="petAge != null">
                pet_age = #{petAge,jdbcType=VARCHAR},
            </if>
            <if test="petType != null">
                pet_type = #{petType,jdbcType=VARCHAR},
            </if>
            <if test="petSex != null">
                pet_sex = #{petSex,jdbcType=VARCHAR},
            </if>
            <if test="petSterilization != null">
                pet_sterilization = #{petSterilization,jdbcType=VARCHAR},
            </if>
            <if test="petVaccine != null">
                pet_vaccine = #{petVaccine,jdbcType=VARCHAR},
            </if>
            <if test="petParasite != null">
                pet_parasite = #{petParasite,jdbcType=VARCHAR},
            </if>
            <if test="petFrom != null">
                pet_from = #{petFrom,jdbcType=VARCHAR},
            </if>
            <if test="petSomatotype != null">
                pet_somatotype = #{petSomatotype,jdbcType=VARCHAR},
            </if>
            <if test="petHair != null">
                pet_hair = #{petHair,jdbcType=VARCHAR},
            </if>
            <if test="petCharacteristic != null">
                pet_characteristic = #{petCharacteristic,jdbcType=VARCHAR},
            </if>
            <if test="adoptRequirements != null">
                adopt_requirements = #{adoptRequirements,jdbcType=VARCHAR},
            </if>
            <if test="story != null">
                story = #{story,jdbcType=VARCHAR},
            </if>
            <if test="address != null">
                address = #{address,jdbcType=VARCHAR},
            </if>
            <if test="wxId != null">
                wx_id = #{wxId,jdbcType=VARCHAR},
            </if>
            <if test="mobilePhone != null">
                mobile_phone = #{mobilePhone,jdbcType=VARCHAR},
            </if>
            <if test="adoptStatus != null">
                adopt_status = #{adoptStatus,jdbcType=VARCHAR},
            </if>
            <if test="memo != null">
                memo = #{memo,jdbcType=VARCHAR},
            </if>
            <if test="createBy != null">
                create_by = #{createBy,jdbcType=VARCHAR},
            </if>
            <if test="createDate != null">
                create_date = #{createDate,jdbcType=TIMESTAMP},
            </if>
            <if test="isValid != null">
                is_valid = #{isValid,jdbcType=VARCHAR},
            </if>
        </set>
        where pet_id = #{petId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.linkpets.core.model.CmsAdoptPet">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun May 19 12:29:03 CST 2019.
        -->
        update cms_adopt_pet
        set pet_name = #{petName,jdbcType=VARCHAR},
        pet_age = #{petAge,jdbcType=VARCHAR},
        pet_type = #{petType,jdbcType=VARCHAR},
        pet_sex = #{petSex,jdbcType=VARCHAR},
        pet_sterilization = #{petSterilization,jdbcType=VARCHAR},
        pet_vaccine = #{petVaccine,jdbcType=VARCHAR},
        pet_parasite = #{petParasite,jdbcType=VARCHAR},
        pet_from = #{petFrom,jdbcType=VARCHAR},
        pet_somatotype = #{petSomatotype,jdbcType=VARCHAR},
        pet_hair = #{petHair,jdbcType=VARCHAR},
        pet_characteristic = #{petCharacteristic,jdbcType=VARCHAR},
        adopt_requirements = #{adoptRequirements,jdbcType=VARCHAR},
        story = #{story,jdbcType=VARCHAR},
        address = #{address,jdbcType=VARCHAR},
        wx_id = #{wxId,jdbcType=VARCHAR},
        mobile_phone = #{mobilePhone,jdbcType=VARCHAR},
        adopt_status = #{adoptStatus,jdbcType=VARCHAR},
        memo = #{memo,jdbcType=VARCHAR},
        create_by = #{createBy,jdbcType=VARCHAR},
        create_date = #{createDate,jdbcType=TIMESTAMP},
        is_valid = #{isValid,jdbcType=VARCHAR}
        where pet_id = #{petId,jdbcType=VARCHAR}
    </update>


    <select id="getList" resultMap="BaseListResultMap">
        SELECT
        p.pet_id,
        pet_name,
        pet_age ,
        pet_type,
        pet_sex ,
        pet_sterilization ,
        pet_vaccine ,
        pet_parasite,
        pet_from ,
        pet_somatotype,
        pet_hair,
        pet_characteristic,
        adopt_requirements,
        story ,
        address,
        wx_id,
        mobile_phone ,
        adopt_status ,
        create_by ,
        p.create_date ,
        p.is_valid
        FROM
        cms_adopt_pet p
        where p.is_valid = '1'
        <if test="null != createBy">
            AND create_by = #{createBy,jdbcType=VARCHAR}
        </if>
        <if test="null != petType and ''!=petType">
            AND pet_type = #{petType,jdbcType=VARCHAR}
        </if>
        <if test="null != adoptStatus">
            <foreach close=")" collection="adoptStatus" item="item" open=" AND adopt_status in (" separator=",">
                #{item,jdbcType=VARCHAR}
            </foreach>
        </if>
        <if test="null != ageArr">
            <foreach close=")" collection="ageArr" item="item" open=" AND pet_age in (" separator=",">
                #{item,jdbcType=VARCHAR}
            </foreach>
        </if>
        <if test="null != sexArr">
            <foreach close=")" collection="sexArr" item="item" open=" AND pet_sex in (" separator=",">
                #{item,jdbcType=VARCHAR}
            </foreach>
        </if>
        <if test="null != sterilization and ''!=sterilization">
            AND pet_sterilization = #{sterilization,jdbcType=VARCHAR}
        </if>
        <if test="null != vaccine and ''!=vaccine">
            AND pet_vaccine = #{vaccine,jdbcType=VARCHAR}
        </if>
        <if test="null != parasite and ''!=parasite">
            AND pet_parasite = #{parasite,jdbcType=VARCHAR}
        </if>
        <if test="null != city and ''!= city">
            AND address = #{city,jdbcType=VARCHAR}
        </if>
        <if test="null != withOutPet and ''!= withOutPet">
            AND p.pet_id != #{withOutPet,jdbcType=VARCHAR}
        </if>
    </select>


    <select id="selectAdoptionImage" resultMap="imageResultMap">
    select media_path
    from  cms_adopt_pet_media
    where pet_id=#{pet_id}
    and is_valid = '1'
  </select>

    <select id="getAdoptPetIdsByUserId" resultType="java.lang.String">
    select pet_id as petId
    from cms_adopt_pet
    where create_by=#{userId}
  </select>

    <select id="getCollectPetList" resultMap="BaseListResultMap">
  	SELECT 
	  p.*
	FROM
	  cms_adopt_pet_collect c
	  left join cms_adopt_pet  p
	  on c.pet_id = p.pet_id
	  where p.is_valid = '1' and c.is_valid= '1' and p.adopt_status = '3'
	  AND c.user_id = #{userId,jdbcType=VARCHAR}
  </select>


    <select id="getFollowedPetList" resultMap="BaseListResultMap">

    SELECT
      p.*
    FROM
      cms_adopt_attention ct
      LEFT JOIN cms_adopt_pet p
        ON ct.attent_by = p.create_by
    WHERE ct.is_valid = '1'
      and p.adopt_status = '3'
      AND ct.user_id = #{userId}

  </select>

    <select id="getPetAdoptCount" resultType="java.lang.Integer">
      SELECT  count(1)
      from cms_adopt_pet
      where left(create_date,10) = #{syncDate}

    </select>

</mapper>